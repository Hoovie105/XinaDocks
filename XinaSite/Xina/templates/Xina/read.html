{% extends 'Xina/main.html' %}
{% block content %}

<h2>{{ doc.title }}</h2>
<p><strong>Created by:</strong> {{ doc.created_by.username }}</p>
<p><strong>Created on:</strong> {{ doc.created_at|date:"M d, Y" }}</p>
<hr>

<p>{{ doc.content }}</p>

{% if attachments %}
  <h4>Attachments:</h4>
  {% for file in attachments %}
    {% if file.is_pdf %}
     <object data="{{ file.file.url }}" type="application/pdf" width="100%" height="500px">
        <p>
          <a href="{{ file.file.url }}" target="_blank">{{ file.file.name }}</a>
        </p>
    </object>
    {% elif file.is_image %}
      <img src="{{ file.file.url }}" alt="attachment" style="max-width:100%; margin-top:10px;">
    {% else %}
      <a href="{{ file.file.url }}" target="_blank">{{ file.file.name }}</a>
    {% endif %}
    {% if can_manage %}
            <form method="POST" action="{% url 'xina:delete_attachment' file.id %}" 
                  style="display: inline-block; margin-top: 5px;">
                {% csrf_token %}
                <button type="submit" class="btn-delete-attachment">
                    Remove Attachment
                </button>
            </form>
        {% endif %}
  {% endfor %}
{% endif %}
{% if can_manage %}
  <hr>
  <form method="POST" action="{% url 'xina:delete' doc.id %}">
    {% csrf_token %}
    <button type="submit" >Delete Document</button>
  </form>
  <form method="POST" action="{% url 'xina:update' doc.id %}">
    {% csrf_token %}
    <button type="submit" >update</button>
  </form>
{% endif %}

<a href="{% url 'xina:main' %}">Â« Back to Documents</a>

{% endblock %}
